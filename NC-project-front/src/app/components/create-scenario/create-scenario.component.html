<div class="row">
  <div class="col-8">
    <div *ngIf="isError" class="alert alert-danger alert-dismissible fade show" role="alert">
      Please, make sure to fill all the fields
      <button type="button" class="close" data-dismiss="alert" aria-label="Close" (click)="closeAlert()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="bg-white shadow-lg p-3">
      <h2 class="color-nc font-italic font-weight-bold"> Test Scenario</h2>

      <div [formGroup]="scenarioForm">
        <label class="m-3 color-nc font-weight-bold"> Name
          <input [@invalidForm]="scenarioForm.controls.name.invalid ? 'invalid': ''" type="text" class="form-control"
                 formControlName="name" [ngModel]="compound?.name">
        </label>
        <label class="m-3 color-nc font-weight-bold"> Description
          <input [@invalidForm]="scenarioForm.controls.description.invalid ? 'invalid': ''" type="text"
                 class="form-control"
                 formControlName="description" [ngModel]="compound?.description">
        </label>
      </div>

      <div cdkDropListGroup class="row actions-container w-100">

        <div class="col-6 float-left">
          <h2 class="color-nc font-italic font-weight-bold">Set of Test Scenario</h2>
          <div [@invalidForm]="emptyInvalid ? 'invalid': ''"
               cdkDropList [id]="'cdk-drop-list-0'"
               [cdkDropListData]="compoundActions"
               class="action-list" (cdkDropListDropped)="drop($event)">
            <div class="action-box"
                 [class]="action.action.type === 'COMPOUND' ? 'border border-success' : ''"
                 *ngFor="let action of compoundActions" (click)="showActionDetails(action)" cdkDrag>
              {{action.action.name}}
            </div>
          </div>
        </div>

        <div class="col-6 float-left">
          <div class="example-container">
            <h2 class="color-nc font-italic font-weight-bold" *ngIf="!nameSearch">Manage library</h2>
            <input #search id="search" type="text" class="form-control form-control-lg" placeholder="Search by name...">
            <br/>
            <div cdkDropList [id]="'cdk-drop-list-1'"
                 [cdkDropListData]="actionsAsCompActionsFiltered"
                 class="action-list" (cdkDropListDropped)="drop($event)">

              <div class="action-box"
                   [class]="item.action.type === 'COMPOUND' ? 'border border-success' : ''"
                   *ngFor="let item of actionsAsCompActionsFiltered" (click)="showActionDetails(item)" cdkDrag>
                {{item.action.name}}
              </div>

            </div>
          </div>
        </div>

      </div>


      <mat-paginator [pageSizeOptions]="[10, 20, 30]" pageSize="{{size}}" length="{{actions.size}}"
                     (page)="pageParamsChange($event)" showFirstLastButtons></mat-paginator>

      <button type="submit" class="btn btn-nc m-3 px-5 py-3 animation"
              (click)="submit()">{{creating ? 'Create' : 'Save'}}</button>
      <button class="btn btn-outline-danger m-3 px-5 py-3" data-toggle="modal" data-target="discardModal"
              (click)="modalShow()">Discard
      </button>
      <button *ngIf="!creating" class="btn btn-outline-danger m-3 px-5 py-3" (click)="modalDelShow()">DELETE</button>
    </div>

    <div *ngIf="!!selectedAction" class="bg-white mt-4 shadow-lg p-5">
      <h1><strong class="color-nc">Name: </strong> <a role="button"
                                                      (click)="navToCompound(selectedAction.action)">{{selectedAction.action.name}}</a>
      </h1>
      <h3><strong class="color-nc">Key: </strong> {{selectedAction.parameterKey.key}}</h3>
      <h3 class="color-nc">Description: </h3>
      <h4>{{selectedAction.action.description}}</h4>
    </div>


    <div class="modal fade" id="discardModal" tabindex="-1" aria-labelledby="discardModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="discardModalLabel">Confirm action</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p>Are you sure you want to discard all changes?</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-outline-danger" data-dismiss="modal"
                    routerLink="{{creating ? '../' : '../../'}}">Discard
            </button>
            <button type="button" class="btn btn-outline-primary" (click)="submit()">Save changes</button>
          </div>
        </div>
      </div>
    </div>
    <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="deleteModalLabel">Confirm action</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p>Are you sure you want to delete this Test Scenario?</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-outline-danger" data-dismiss="modal" (click)="delete()">Delete</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
